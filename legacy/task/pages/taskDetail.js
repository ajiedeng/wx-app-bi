"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){function a(n,r){try{var o=t[n](r),s=o.value}catch(e){return void i(e)}if(!o.done)return Promise.resolve(s).then(function(e){a("next",e)},function(e){a("throw",e)});e(s)}return a("next")})}}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),_wepy=require("./../../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_topBar=require("./../../components/topBar.js"),_topBar2=_interopRequireDefault(_topBar),_toast=require("./../../mixins/toast.js"),_toast2=_interopRequireDefault(_toast),_commonApi=require("./../../mixins/commonApi.js"),_commonApi2=_interopRequireDefault(_commonApi),_http=require("./../../utils/http.js"),_utils=require("./../../utils/utils.js"),_utils2=_interopRequireDefault(_utils),_slot=require("./../../utils/slot.js"),_loginInfo=require("./../../utils/loginInfo.js"),_formatfile=require("./../../utils/formatfile.js"),wxApis=require("./../../utils/wxApi.js"),taskDetail=function(e){function t(){var e,i,a,n;_classCallCheck(this,t);for(var r=arguments.length,o=Array(r),s=0;s<r;s++)o[s]=arguments[s];return i=a=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.config={},a.data={jobInfo:{},preload:{},options:{},jobId:"",loadUrl:"",height:0,topNum:0,taskItemInfo:{},taskAuditHistory:[],taskRemarkList:[],currentUserid:"",userInfo:"",imgFlag:!1,isBasicHidden:!1,isModelHidden:!1,isChargerHidden:!1,isRecordHidden:!1,isHistoryTab:!0,pt_show_list:[],hideBtns:[],fileImages:[],remarkValue:"",tempFiles:[],page:{history:{pagesize:-1,pageid:0},remark:{pagesize:-1,pageid:0}},normalBtn:{},abnormalBtn:[],atIdLists:[],atIds:[],nameArr:[],isFileFail:!0,meetingDid:"",meetingData:{isreserved:"",isreservedname:"",did:"",name:"",meetingroom:"",meetingroomname:"",mtstartdate:_utils2.default.formatDateday(),mtenddate:"",mtdate:"",mttime:"",starttime:null,endtime:null,meetingdate:parseInt(Date.now/1e3),deputyorganizer:"",deputyorganizername:"",note:"",relateusers:[],relatelabels:"",iscanfind:""}},a.mixins=[_toast2.default,_commonApi2.default],a.events={parentBackFn:function(){_wepy2.default.navigateBack()}},a.$repeat={},a.$props={topTaskDetail:{"xmlns:v-on":"",bindparentBackFn:"parentBackFn"}},a.$events={topTaskDetail:{"v-on:topNavFn":"getScrollHeight"}},a.components={topTaskDetail:_topBar2.default},a.methods={getScrollHeight:function(e,t){var i=this;wx.getSystemInfo({success:function(t){i.$parent.globalData.windowWH={width:t.windowWidth,height:t.screenHeight},i.height=t.windowHeight-e,i.$apply()}})},hideBasicInfo:function(e){this.isBasicHidden=e},hideModelInfo:function(e){this.isModelHidden=e},hideChargerInfo:function(e){this.isChargerHidden=e},hideRecordInfo:function(e){this.isRecordHidden=e},toggleHistoryTab:function(e){this.isHistoryTab=e,this.getAuditHistory()},toggleCommentTab:function(e){this.isHistoryTab=e,this.getRemark()},bindKeyInput:function(e){this.remarkValue=e.detail.value},inputBlur:function(e){var t=this;this.remarkValue=e.detail.value,this.atIdLists=this.atIdLists&&this.atIdLists.filter(function(e){return t.remarkValue.indexOf("@"+e.nickname)>=0}),this.nameArr=this.nameArr&&this.nameArr.filter(function(e){return t.remarkValue.indexOf(e)>=0}),this.$parent.globalData.atIdLists=this.atIdLists||[]},toCommitRemark:function(e){(this.remarkValue||0!==this.fileImages.length)&&this.commitRemark()},toTaskFlow:function(){var e={jobInfo:this.jobInfo};this.$preload("jobInfo",e),_wepy2.default.navigateTo({url:"./taskFlow"})},previewImage:function(e,t){this.imgFlag=!0,t=t.map(function(e){if(e.isImg)return e.downloadUrl}),_wepy2.default.previewImage({current:e.downloadUrl,urls:t})},downloadFile:function(e){var t=this;this.imgFlag=!0,wx.downloadFile({url:e,header:{Cookie:(0,_loginInfo.getCookie)()},success:function(e){var i=e.tempFilePath;wx.openDocument({filePath:i,success:function(e){},fail:function(){t.failFileOpen()}})}})},uploadDescFile:function(){var e=this,t=this;this.imgFlag=!0,this.fileImages=[],wx.chooseImage({count:1,success:function(e){t.tempFilePaths=e.tempFilePaths,t.tempFiles=e.tempFiles,t.fileImages=[].concat(_toConsumableArray(t.fileImages),_toConsumableArray(e.tempFilePaths)),t.isFileFail=!1,t.$apply()},fail:function(i){e.isFileFail=!1,i.errMsg&&"chooseImage:fail cancel"!==i.errMsg&&t.failFileUpload(),e.$apply()}})},deleteUploadFile:function(e){this.fileImages.splice(e,1)},auditTask:function(e,t){var i={nextId:t,jobId:this.jobId,showType:this.showType,action:e};i=JSON.stringify(i),this.$preload("jobAudit",i),this.$parent.globalData.jobId=this.jobId,_wepy2.default.navigateTo({url:"./taskAudit"})},modifyCharger:function(e,t){if(this.currentUserid===this.jobInfo.relate_user_id){var i={nodeId:e,nextName:t,jobId:this.jobId};this.$preload("nodeInfo",i),_wepy2.default.navigateTo({url:"./taskCharger"})}},batchAddCC:function(){this.jobInfo.canChangeCC&&(this.$preload("detailJobId",this.jobId),_wepy2.default.navigateTo({url:"./taskCC"}))},delCC:function(e){var t=this;this.jobInfo.canChangeCC&&this.showCommonModal({content:"是否确定删除该抄送人？"},function(){t.confirmDeleteCC(e.user_id,e.group_id)})},toAt:function(){this.$preload("isAt",!0),_wepy2.default.navigateTo({url:"./taskCC"})}},n=i,_possibleConstructorReturn(a,n)}return _inherits(t,e),_createClass(t,[{key:"onShareAppMessage",value:function(){return{title:"BroadLink 智慧办公 - 任务详情",path:"task/pages/taskDetail"}}},{key:"getRemark",value:function(){function e(){return t.apply(this,arguments)}var t=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={task_id:this.jobId,pagesize:this.page.remark.pagesize,pageid:this.page.remark.pageid},e.prev=1,e.next=4,(0,_http.queryTaskLog)(t);case 4:i=e.sent,i&&0===i.status?(this.taskRemarkList=i.list||[],this.taskRemarkList.length>0&&this.taskRemarkList.forEach(function(e){e.created_at=_utils2.default.formatDateTime(e.created_at),e.attachments=e.attachments||[],e.attachments&&e.attachments.length>0&&e.attachments.forEach(function(e){var t=e.file_name.split(".")[e.file_name.split(".").length-1].toLowerCase();e.isImg="jpg"===t||"jpeg"===t||"png"===t;var i=a.loadUrl+"?sourceid="+e.source_id+"&loginSession="+a.userInfo.loginsession+"&requserid="+a.userInfo.userid;e.downloadUrl=e.isImg?(0,_formatfile.appendCookieToUrl)(i):i})}),this.$apply()):wxApis.logMethod("log","queryTaskLog = "+JSON.stringify(i),!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),wxApis.logMethod("log","queryTaskLog = "+JSON.stringify(e.t0),_wepy2.default.$instance.globalData.logInfo);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return e}()},{key:"confirmDeleteCC",value:function(){function e(e,i){return t.apply(this,arguments)}var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t,i){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t?"jobid="+this.jobId+"&userid="+t:"jobid="+this.jobId+"&groupid="+i,e.prev=1,e.next=4,(0,_http.delDetailCC)({},a);case 4:n=e.sent,n&&0===n.status&&(this.getJobInfo(),this.getAuditHistory()),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),wxApis.logMethod("log","delDetailCC = "+JSON.stringify(e.t0),_wepy2.default.$instance.globalData.logInfo);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return e}()},{key:"commitRemark",value:function(){var e=this,t=this;t.atIdLists&&t.atIdLists.forEach(function(e){t.atIds.push(e.user_id)}),t.addImages(t.fileImages,t.tempFiles,function(){var i=_asyncToGenerator(regeneratorRuntime.mark(function i(a){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={task_id:t.jobId,task_name:t.jobInfo.job_name,creat_user_name:t.userInfo.nickname,status:t.jobInfo.status,mark:t.userInfo.nickname+"："+t.remarkValue,at_sign_user_ids:t.atIds||[],attachments:a},e.prev=1,e.next=4,(0,_http.putTaskLog)(n);case 4:t.getRemark(),wx.hideKeyboard(),t.remarkValue="",t.fileImages=[],t.atIds=[],t.nameArr=[],t.atIdLists=[],t.$parent.globalData.atIdLists=[],e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),wxApis.logMethod("log","putTaskLog = "+JSON.stringify(e.t0),_wepy2.default.$instance.globalData.logInfo);case 17:case"end":return e.stop()}},i,e,[[1,14]])}));return function(e){return i.apply(this,arguments)}}())}},{key:"getJobInfo",value:function(){function e(){return t.apply(this,arguments)}var t=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,i,a,n,r,o,s,l,u,f,d,c=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={job_id:this.jobId},i={},e.next=4,(0,_http.queryJobInfo)(t);case 4:if(a=e.sent,this.jobInfo=a.info||{},this.jobInfo.created_at=_utils2.default.formatDateTime(this.jobInfo.created_at),this.jobInfo.relate_user_name="ENDING"===this.jobInfo.status?"无":this.jobInfo.relate_user_name,this.loadUrl=this.$parent.globalData.baseUrl+"cloudproject/v1/query/file",a.hidden_actions&&(this.hideBtns=JSON.parse(a.hidden_actions)),this.jobInfo.desc_info&&(this.jobInfo.modelList=JSON.parse(this.jobInfo.desc_info)),this.jobInfo.relateiconpath||(this.jobInfo.relateiconpath="../../assets/images/task/default_photo.png"),this.jobInfo.role_list=this.jobInfo.role_list||[],this.jobInfo.modelList=this.jobInfo.modelList||[],this.jobInfo.assignCCList=[],this.jobInfo.role_list.forEach(function(e){"CC"===e.role_name&&e.nickname?c.jobInfo.assignCCList.push({user_id:e.user_id,nickname:e.nickname}):"CCG"===e.role_name&&c.jobInfo.assignCCList.push({group_id:e.group_id,group_name:e.group_name})}),this.currentUserid===this.jobInfo.relate_user_id||this.currentUserid===this.jobInfo.creat_user_id?this.jobInfo.canChangeCC=!0:this.jobInfo.canChangeCC=!1,n=this.jobInfo.modelList.filter(function(e){return"2"===e.modeltype}),r=this.jobInfo.modelList.filter(function(e){return"8"===e.modeltype}),o=this.jobInfo.modelList.filter(function(e){return"8"!==e.modeltype&&"2"!==e.modeltype}),this.jobInfo.modelList=[].concat(_toConsumableArray(o),_toConsumableArray(n),_toConsumableArray(r)),this.jobInfo.modelList.forEach(function(e,t){if(e.canShow=!0,null==e.value&&(e.value=""),"4"===e.modeltype&&e.value){e.multi_attach_buff=JSON.parse(e.value),e.imageArr=[],e.fileArr=[],c.loadUrl=c.$parent.globalData.baseUrl+"cloudproject/v1/query/file",e.multi_attach_buff.forEach(function(t){if(t){var i=c.loadUrl+"?sourceid="+t.source_id+"&loginSession="+c.userInfo.loginsession+"&requserid="+c.userInfo.userid;if(t.file_name&&t.file_name.indexOf(".")>0){var a=t.file_name.split(".")[t.file_name.split(".").length-1].toLowerCase();"jpg"===a||"jpeg"===a||"png"===a?(t.isImg=!0,t.downloadUrl=(0,_formatfile.appendCookieToUrl)(i),e.imageArr.push(t.downloadUrl)):(t.isImg=!1,t.downloadUrl=i,e.fileArr.push(t.downloadUrl))}}});var a=e.multi_attach_buff.filter(function(e){return e.isImg}),n=e.multi_attach_buff.filter(function(e){return!e.isImg});e.multi_attach_buff=[].concat(_toConsumableArray(a),_toConsumableArray(n))}if("11"===e.modeltype&&(e.value||(e.value=Object.assign({},c.meetingData)),e.value)){var r="string"==typeof e.value?JSON.parse(e.value)||{}:e.value,o=r.did;o&&!i[o]&&(i[o]={index:t,did:o})}if("8"===e.modeltype)if(e.tbodyArray.length>0)e.tbodyArray.forEach(function(e){e.forEach(function(e){if("file"===e.columnsType){var t=e.value&&JSON.parse(e.value);e.multi_attach_buff=t||[e.fileInfo]||[],e.attachfileArr=t||[e.fileInfo]||[],e.fileNameArr=[],e.imgUrlArr=[],e.multi_attach_buff.length>0&&e.multi_attach_buff.forEach(function(t){if(t){var i=c.loadUrl+"?sourceid="+t.source_id+"&loginSession="+c.userInfo.loginsession+"&requserid="+c.userInfo.userid;if(e.imgUrlArr.push((0,_formatfile.appendCookieToUrl)(i)),e.fileNameArr.push(t.file_name),t.file_name&&t.file_name.indexOf(".")>0){var a=t.file_name.split(".")[t.file_name.split(".").length-1].toLowerCase();"jpg"===a||"jpeg"===a||"png"===a?(t.downloadUrl=(0,_formatfile.appendCookieToUrl)(i),t.isImg=!0):(t.downloadUrl=i,t.isImg=!1)}}})}})});else{e.tbodyArray=[];var s=[];e.tableObj.columns.forEach(function(e){var t={columnsName:e.columnsName,rowsName:"",columnsType:e.columnsType,content:""};s.push(t)}),e.tbodyArray.push(s)}}),this.getFlowNode(),!(s=_utils2.default.isEmptyObj(i)))for(l in i)u=i[l],f=u.index,d=u.did,this.queryMeetingInfo(f,d);this.$apply();case 26:case"end":return e.stop()}},e,this)}));return e}()},{key:"getUserList",value:function(){function e(e){return t.apply(this,arguments)}var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={job_id:this.jobId},e.prev=1,e.next=4,(0,_http.queryUserList)(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),wxApis.logMethod("log","getUserList = "+JSON.stringify(e.t0),_wepy2.default.$instance.globalData.logInfo);case 9:case"end":return e.stop()}},e,this,[[1,6]])}));return e}()},{key:"getAuditHistory",value:function(){function e(){return t.apply(this,arguments)}var t=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={condition:{project_id:this.jobId},pagesize:this.page.history.pagesize,pageid:this.page.history.pageid},e.prev=1,e.next=4,(0,_http.queryAuditHistory)(t);case 4:i=e.sent,this.taskAuditHistory=i.list,this.taskAuditHistory=this.taskAuditHistory||[],this.loadUrl=this.$parent.globalData.baseUrl+"cloudproject/v1/query/file",this.taskAuditHistory.forEach(function(e,t){if(e.CreatedAt=_utils2.default.formatDateTime(e.CreatedAt),100!==e.log_type){try{e.infoParse=JSON.parse(e.info)||{}}catch(e){wxApis.logMethod("log","queryAuditHistory infoParse = "+JSON.stringify(e),_wepy2.default.$instance.globalData.logInfo)}if(e.infoParse.file_name){e.infoParse.imgArr=[];var i=a.loadUrl+"?sourceid="+e.infoParse.source_id+"&loginSession="+a.userInfo.loginsession+"&requserid="+a.userInfo.userid,n=e.infoParse.file_name.split(".")[e.infoParse.file_name.split(".").length-1].toLowerCase();"jpg"===n||"jpeg"===n||"png"===n?(e.infoParse.downloadUrl=(0,_formatfile.appendCookieToUrl)(i),e.infoParse.imgArr.push({downloadUrl:(0,_formatfile.appendCookieToUrl)(i),isImg:!0}),e.infoParse.isImg=!0):(e.infoParse.downloadUrl=i,e.infoParse.isImg=!1)}}}),this.$apply(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),wxApis.logMethod("log","queryAuditHistory = "+JSON.stringify(e.t0),_wepy2.default.$instance.globalData.logInfo);case 15:case"end":return e.stop()}},e,this,[[1,12]])}));return e}()},{key:"getFlowNode",value:function(){function e(){return t.apply(this,arguments)}var t=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,i,a,n,r,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={flowid:this.jobId},e.prev=1,e.next=4,(0,_http.queryTaskFlow)(t);case 4:for(i=e.sent,this.normalBtn=i.next_node,this.abnormalBtn=i.back,this.showType=i.showtype,a=i.pt_show_type||"1",n=0;n<this.hideBtns.length;n++)for(this.hideBtns[n]===this.normalBtn.road_name&&(this.normalBtn.shouldHide=!0),r=0;r<this.abnormalBtn.length;r++)this.hideBtns[n]===this.abnormalBtn[r].road_name&&(this.abnormalBtn[r].shouldHide=!0);this.jobInfo.modelList=this.jobInfo.modelList||[],i.pt_show_list_str&&(this.pt_show_list=JSON.parse(i.pt_show_list_str)),e.t0=a,e.next=1===e.t0?15:2===e.t0?17:3===e.t0?19:21;break;case 15:return this.jobInfo.modelList.forEach(function(e){e.canShow=!0}),e.abrupt("break",22);case 17:return this.jobInfo.modelList.forEach(function(e){e.canShow=!1,o.pt_show_list.forEach(function(t){e.modelname===t&&(e.canShow=!0)})}),e.abrupt("break",22);case 19:return this.jobInfo.modelList.forEach(function(e){e.canShow=!0,o.pt_show_list.forEach(function(t){e.modelname===t&&(e.canShow=!1)})}),e.abrupt("break",22);case 21:return e.abrupt("break",22);case 22:this.$apply(),e.next=28;break;case 25:e.prev=25,e.t1=e.catch(1),wxApis.logMethod("log","getFlowNode = "+JSON.stringify(e.t1),_wepy2.default.$instance.globalData.logInfo);case 28:case"end":return e.stop()}},e,this,[[1,25]])}));return e}()},{key:"addImages",value:function(){function e(e,i,a){return t.apply(this,arguments)}var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t,i,a){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],e.prev=1,r=0;case 3:if(!(r<t.length)){e.next=12;break}return e.next=6,(0,_http.uploadFile)({filePath:t[r],formData:{file:i}});case 6:o=e.sent,o=JSON.parse(o),o.sourceid&&n.push(o.sourceid);case 9:r++,e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),wxApis.logMethod("log","uploadFile = "+JSON.stringify(e.t0),_wepy2.default.$instance.globalData.logInfo);case 17:a&&a(n);case 18:case"end":return e.stop()}},e,this,[[1,14]])}));return e}()},{key:"queryMeetingInfo",value:function(){function e(e,i){return t.apply(this,arguments)}var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t,i){var a,n,r,o,s,l,u,f,d,c,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_http.queryMeetingInfo)({did:i});case 2:if(a=e.sent,0===a.status){for(n=a.data||{},r=(0,_slot.generateStampTime)(n.starttime,n.endtime),o=n.relateusers,s=0,l=0,u="",f=o.length,d=0;d<f;d++)c=o[d],1===c.attendstatus?s++:2===c.attendstatus&&l++;f>0&&(u="已邀请"+f+"人,"+s+"人参加,"+l+"人不参加"),this.jobInfo.modelList[t].value={isreserved:"0",isreservedname:"是",did:n.did||"",name:n.name||"",meetingroom:n.meetingroom||"",meetingroomname:n.room.name||"",mtstartdate:_utils2.default.formatDateday(),mtenddate:"",mtdate:_utils2.default.formatDateday(1e3*n.meetingdate)||"",mttime:r||"",starttime:n.starttime||null,endtime:n.endtime||null,meetingdate:n.meetingdate||"",deputyorganizer:n.deputyorganizer||"",deputyorganizername:n.deputyorganizername||"",note:n.note||"",relateusers:n.relateusers||[],relatelabels:u,iscanfind:!0}}else h=this.jobInfo.modelList[t].value,h?(h="string"==typeof h?JSON.parse(h)||{}:h,h=Object.assign(this.meetingData,h,{iscanfind:!1})):h=Object.assign(this.meetingData,{iscanfind:!1}),this.jobInfo.modelList[t].value=h;this.$apply();case 5:case"end":return e.stop()}},e,this)}));return e}()},{key:"onLoad",value:function(e,t){t=t||{},e&&e.jobid&&(this.options=e||{}),this.preload=t.preload||{}}},{key:"onShow",value:function(){var e=this;if(this.$parent.globalData.userInfo=(0,_loginInfo.getUserInfo)(),this.userInfo=this.$parent.globalData.userInfo,this.currentUserid=this.userInfo.userid,this.jobId=this.preload.jobId||this.options.jobid||this.$parent.globalData.jobId||"",this.imgFlag&&this.isFileFail)return!1===this.imgFlag;this.currentUserid,this.jobId&&(this.getJobInfo(),this.getUserList(),this.getAuditHistory(),this.getRemark(),this.topNum=0);var t=this.$parent.globalData.atIdLists||[];this.atIdLists=this.atIdLists||[],this.atIdLists=[].concat(_toConsumableArray(this.atIdLists),_toConsumableArray(t)),this.atIdLists=this.handleRepeat(this.atIdLists,"user_id"),this.$parent.globalData.atIdLists=this.atIdLists;var i="";t.length>0&&t.forEach(function(t){e.nameArr.indexOf(t.nickname)<0&&(e.nameArr.push(t.nickname),i+="@"+t.nickname+"; ")}),this.remarkValue+=i,this.$apply()}}]),t}(_wepy2.default.page);Page(require("./../../npm/wepy/lib/wepy.js").default.$createPage(taskDetail,"task/pages/taskDetail"));