"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var s=e.apply(this,arguments);return new Promise(function(e,t){function a(i,r){try{var u=s[i](r),n=u.value}catch(e){return void t(e)}if(!u.done)return Promise.resolve(n).then(function(e){a("next",e)},function(e){a("throw",e)});e(n)}return a("next")})}}function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,s){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!s||"object"!=typeof s&&"function"!=typeof s?e:s}function _inherits(e,s){if("function"!=typeof s&&null!==s)throw new TypeError("Super expression must either be null or a function, not "+typeof s);e.prototype=Object.create(s&&s.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),s&&(Object.setPrototypeOf?Object.setPrototypeOf(e,s):e.__proto__=s)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,s){for(var t=0;t<s.length;t++){var a=s[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(s,t,a){return t&&e(s.prototype,t),a&&e(s,a),s}}(),_wepy=require("./../../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_topBar=require("./../../components/topBar.js"),_topBar2=_interopRequireDefault(_topBar),_utils=require("./../../utils/utils.js"),_utils2=_interopRequireDefault(_utils),_toast=require("./../../mixins/toast.js"),_toast2=_interopRequireDefault(_toast),_http=require("./../../utils/http.js"),wxApis=require("./../../utils/wxApi.js"),search=function(e){function s(){var e,t,a,i;_classCallCheck(this,s);for(var r=arguments.length,u=Array(r),n=0;n<r;n++)u[n]=arguments[n];return t=a=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(u))),a.data={searchValue:"",issueSubClassParams:{pagesize:9999,pageid:0,user_bit:1,show_flag:1,issue_class:null,issue_class_name:"",issue_sub_class_name:""},allIssueSubClassList:[],tempAllList:[],height:0},a.$repeat={},a.$props={topsearch:{"xmlns:v-on":"",bindparentBackFn:"parentBackFn"}},a.$events={topsearch:{"v-on:topNavFn":"getScrollHeight"}},a.components={topsearch:_topBar2.default},a.mixins=[_toast2.default],a.events={parentBackFn:function(){_wepy2.default.navigateBack()}},a.methods={getScrollHeight:function(e,s){var t=this,a=this.$parent.globalData.windowWH||{},i=a.height;i=i||667;var r=wx.createSelectorQuery();r.select("#taskCreateSearch").boundingClientRect(),r.exec(function(s){s[0]&&null!==s[0]&&s[0].height&&(t.height=i-s[0].height-e,t.$apply())})},searchChange:function(e){""===e.detail.value.trim()&&(this.allIssueSubClassList.length,this.allIssueSubClassList=this.tempAllList),this.searchValue=e.detail.value.trim();var s=[];s=this.tempAllList.filter(function(s){return s.issue_class_name.indexOf(e.detail.value)>-1||s.issue_sub_class_name.indexOf(e.detail.value)>-1}),this.allIssueSubClassList=s},searchEnter:function(){""===this.searchValue.trim()&&(this.allIssueSubClassList.length,this.allIssueSubClassList=this.tempAllList)},searchConfirm:function(){this.searchValue.trim()||(this.allIssueSubClassList=this.tempAllList)},searchClear:function(){this.searchValue="",this.allIssueSubClassList=this.tempAllList},fillInput:function(e){this.searchValue=e.issue_class_name+" / "+e.issue_sub_class_name;var s={issueClass:e.issue_class,issueSubClass:e.issue_sub_class,issueClassName:e.issue_class_name,issueSubClassName:e.issue_sub_class_name};this.$parent.globalData.issueInfo=s,_wepy2.default.navigateBack()}},i=t,_possibleConstructorReturn(a,i)}return _inherits(s,e),_createClass(s,[{key:"getIssueSubClassList",value:function(){function e(){return s.apply(this,arguments)}var s=_asyncToGenerator(regeneratorRuntime.mark(function e(){var s,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s={user_bit:1,show_flag:1,issue_class:this.issueSubClassParams.issue_class,issue_class_name:this.issueSubClassParams.issue_class_name,issue_sub_class_name:this.issueSubClassParams.issue_sub_class_name,pagesize:this.issueSubClassParams.pagesize,pageid:this.issueSubClassParams.pageid},e.prev=1,e.next=4,(0,_http.queryIssueSubClassList)(s);case 4:t=e.sent,t&&0===t.status?t.list&&t.list.length>0&&(this.allIssueSubClassList=t.list,this.tempAllList=t.list,this.allIssueSubClassList.sort(_utils2.default.sortBy("issue_class")),this.$apply()):wxApis.logMethod("log","queryIssueSubClassList = "+JSON.stringify(t),!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),wxApis.logMethod("log","queryIssueSubClassList = "+JSON.stringify(e.t0),_wepy2.default.$instance.globalData.logInfo);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return e}()},{key:"onLoad",value:function(){}},{key:"onShow",value:function(){this.getIssueSubClassList()}}]),s}(_wepy2.default.page);Page(require("./../../npm/wepy/lib/wepy.js").default.$createPage(search,"task/pages/taskCreateSearch"));